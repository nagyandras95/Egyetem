// Multiplie.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>

class TopObject {
public:
	virtual void send () = 0;
};

template<typename Base, typename BEHAV>
class Object : virtual protected BEHAV, public Base {
public:
	virtual void send () {
		static_cast<BEHAV*>(this)->specialSend ();
	}
};

class SM {
public:
	virtual void specialSend () {
		std::cout << "SM send" << std::endl;
	}
};

class NSM  {
public:
	virtual void specialSend () {
		std::cout << "NSM send" << std::endl;

	}
};

class A : public Object<TopObject, NSM> {

};


class B : public Object<A, SM> {
public:
};

class C : public Object<B, NSM> {

};

void f (TopObject* o) {
	o->send ();
}

int main()
{
	A* a = new A();
	a->send ();
	B* b = new B ();
	b->send ();
	C* c = new C ();
	c->send ();
	a = b;
	a->send ();
	f (a);
	std::cin.get ();
    return 0;
}

